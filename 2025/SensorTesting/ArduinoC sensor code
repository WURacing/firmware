const int numSensors = 6;
const int sensorPins[numSensors] = {A0, A1, A2, A3, A4, A5};

void setup() {
  Serial.begin(9600);
}

void loop() {
  // Check for serial input first to ensure immediate response
  if (Serial.available() > 0) {
    String input = Serial.readStringUntil('\n');
    input.trim();

    if (input.equalsIgnoreCase("END")) {
      Serial.println("DATA_END");  // Termination signal for Python
      return;
    }
    else {
      // Read sensors immediately when input is received
      float voltages[numSensors];
      for (int i = 0; i < numSensors; i++) {
        int sensorValue = analogRead(sensorPins[i]);
        voltages[i] = sensorValue * (5.0 / 1023.0);
      }
      
      // Send CSV-formatted response: temp,A0,A1,A2,A3,A4,A5
      Serial.print(input);  // Echo back the received temperature
      for (int i = 0; i < numSensors; i++) {
        Serial.print(',');
        Serial.print(voltages[i]);
      }
      Serial.println();
    }
  }
  
  // Small delay to stabilize the connection
  delay(50);
}
